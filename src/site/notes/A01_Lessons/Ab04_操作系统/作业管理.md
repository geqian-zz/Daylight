---
{"dg-publish":true,"aliases":[null],"tags":["1_AtomNote"],"number headings":"auto, first-level 1, max 6, A.1.","Created-Date":"2024-03-04 10:25:56","Modified-Date":"2024-04-18 11:53:21","permalink":"/A01_Lessons/Ab04_操作系统/作业管理/","dgPassFrontmatter":true}
---



# A. 作业的基本概念

- 作业
	- 用户一次请求计算机系统为他完成任务所进行的工作总和
	- 就是一堆程序数据
- 作业步
	- 为了完成其任务，可以将作业细分成若干个作业步。作业步就是处理作业的各个独立的子任务，系统可以创建若干进程完成各作业步的计算。


## A.1. 作业的分类

根据作业处理方式的不同，可以把作业分为两大类：
- 脱机作业：不直接交互，通常用于批处理系统
- 联机作业：直接交互，通常用于分时系统和目前的微机系统




## A.2. 作业的组成

1. 程序
2. 数据
3. 作业控制信息（如作业说明书）
	1. 作业基本情况：如用户名、作业名
	2. 作业控制描述：如作业控制方式、出错处理
	3. 作业资源要求描述：如处理时间、优先级、内存空间






# B. 作业的处理过程



## B.1. 作业控制块（Job Control Block, JCB)

作业控制块是作业存在的唯一标志，是系统为管理作业所设置的一个数据结构。每个作业进入系统，系统为其建立 JCB.


1. 作业名
2. 用户名
3. 内存需求量
4. 估计执行时间
5. 优先数（用于调度）
6. 作业类型
7. 作业说明书文件名 
8. 资源要求量
9. 作业状态：提交、后备、执行、就绪、等待、完成；
10. 作业存储信息：输入井地址和输出井地址


作业后备队列就是按照某种原则将后备作业的 JCB 排成的一个或多个序列，以便作业调度。





# C. 作业的输入/输出方式


- 联机输入/输出
- 脱机输入/输出
- SPOOLing 系统 (假脱机)



## C.1. SPOOLing 系统的应用：共享打印机

![Pasted image 20240304110024.png](/img/user/Z02_ObFiles/Attachments/Pasted%20image%2020240304110024.png)



打印机为独占设备,利用 SPOOLing 技术，改造为共享设备

当用户请求打印时，SPOOLing 系统处理如下：
- 输出进程在输出井中申请一个空闲磁盘块区, 并将数据送入。
- 输出进程从输出井把数据送到内存缓冲区，启动打印机打印。






# D. 作业调度


## D.1. 三级调度

在一些操作系统中，一个作业从提交到完成需要经过高级、中级和低级三级调度

- 高级调度：即作业调度，选择后备作业，为其建立进程，并使其进入主机。
	- 频次低
- 中级调度：即对换调度，决定进程在内存和辅存交换区间的对换。
- 低级调度：即进程调度，决定哪个进程可以占用 CPU，进入运行状态。
	- 频次高


## D.2. 作业调度算法的评价


![Pasted image 20240401110651.png](/img/user/Z02_ObFiles/Attachments/Pasted%20image%2020240401110651.png)

- 作业 $J_i$
	- 提交时间 $t_{si}$
	- 执行时间 $t_{ri}$
	- 完成时间 $t_{oi}$

- 单个作业周转时间 $\quad T_i=t_{o i}-t_{s i}, \quad i=1,2, \ldots, n$
- 单个作业带权周转时间 $W_i=T_i / t_{r i}, \quad i=1,2, \ldots, n$




## D.3. 作业调度算法




### D.3.1. 单道批处理系统作业调度算法

#### D.3.1.1. 先来先服务 (FCFS)


- 有利于长作业
- 不利于短作业

短作业等待时间长，忽视了吞吐量和平均周转时间；


#### D.3.1.2. 短作业优先调度算法 (SJF)

作业的平均等待时间短，系统的吞吐量大。对长作业不利，容易致使长作业出现“饥饿”现象；没有考虑到作业的紧迫程度。

#### D.3.1.3. 最高响应比优先调度算法 (HRP)

响应比 RP
＝作业响应时间/作业估计运行时间
＝(作业估计运行时间 + 作业等待时间) / 作业估计运行时间
＝ 1 + 作业等待时间/作业估计运行时间

- 运行时间越短，响应比越大，作业排的越靠前——短作业优先
- 等待时间越长，响应比越大，作业排的越靠前——先来先服务


### D.3.2. 多道批处理系统作业调度算法


- **优先级调度算法**：优先级高的作业先启动。
- **均衡调度算法**：根据系统的运行情况和作业本身的特性对作业进行分类。作业调度程序轮流地从这些不同类别的作业中挑选作业执行。




# E. 作业控制方式

1. 脱机作业控制
	1. 作业输入控制说明书，整个作业的运行由系统控制
2. 联机作业控制
	1. 通过联机命令控制语言和会话式程序设计语言控制作业运行



# F. 系统功能调用
## F.1. 系统调用的执行流程



![Pasted image 20240306085641.png](/img/user/Z02_ObFiles/Attachments/Pasted%20image%2020240306085641.png)






## F.2. 系统功能调用与普通过程调用的区别


- **运行状态不同**。系统调用的调用过程和被调用过程运行在不同的状态，而普通的过程调用运行在相同的状态。
- **调用方法不同**。系统调用必须通过中断机制首先进入系统核心，然后才能转向相应的命令处理程序。普通过程调用可以直接由调用过程转向被调用过程。
- **返回问题**。普通的过程调用直接返回调用过程继续执行。对于系统调用，由于发生状态的改变，在返回时可能需要重新进行调度分析 (如抢占式调度的系统)。
- **嵌套或递归调用**。对系统调用，一般不允许在同一个进程中发生嵌套或递归。



## F.3. 系统调用的功能


- 设备管理：设备的读写与控制
- 文件管理：文件读写、文件控制和文件保护
- 进程控制：创建、终止、暂停等控制
- 进程通信：消息队列、共享存储区、socket 等通信渠道的建立、使用和删除
- 存储管理：内存的申请和释放
- 系统管理：设置和读取时间、读取用户和主机标识等



